<!doctype html>
<html lang="en">
<head>
    <title>The Drought</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="components/bootstrap/dist/css/bootstrap.css">
    
    <link rel="stylesheet" type="text/css" href="components/jquery-ui/themes/ui-lightness/jquery-ui.css">
    <link rel="stylesheet" type="text/css" href="css/drought.css">
    
    <style type="text/css">
    body { padding-top: 100px; }

    #slider { 
        margin-top: 1em; 
        margin-bottom: 1em;
    }

    .week {
        display: none;
    }

    .week.active {
        display: block;
    }


    </style>
</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="row">
            <div class="col-lg-12">
                <h1>The Drought</h1>
                <div id="slider"></div>
            </div>
        </div>
    </nav>

    <div class="container">
        <div id="maps" class="row"></div>
    </div>

    <script src="js/weeks.js"></script>
    <script src="components/underscore/underscore.js"></script>
    <script src="components/d3/d3.min.js" charset="utf-8"></script>
    <script src="components/jquery/jquery.min.js"></script>
    <script src="components/jquery-ui/ui/jquery-ui.js"></script>

    <script type="text/javascript">
    var IMG_PATH = "/img/drought/"
      , format = d3.time.format('usdm%y%m%d');

    var nest = d3.nest().key(function(d) {
        return format.parse(d).getFullYear();
    }).sortKeys(d3.descending);

    var years = d3.select('#maps').selectAll('.year')
        .data(nest.entries(WEEKS));
    
    years.enter().append('div')
        .attr('class', 'year col-lg-12')
        .attr('id', function(d) { return 'year-' + d.key; });

    var weeks = years.selectAll('.week')
        .data(function(d) { return d.values; });
    
    weeks.enter().append('div')
        .classed('week', true)
        .classed('active', function(d, i) { return i === 0; })
      .append('img')
        .attr('src', function(d) { return IMG_PATH + d + '.png'; })
        .classed('img-responsive', true)
    
    weeks.append('h2')
        .text(function(d) {
            return format.parse(d).toDateString();
        });

    var slider = $('#slider').slider({
        max: 51,
        slide: function(e, ui) {
            weeks.classed('active', function(d, i) { return ui.value === i; });
        }

    });

    </script>

</body>
</html>